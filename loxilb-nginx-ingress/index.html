<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://loxilb-io.github.io/loxilbdocs/loxilb-nginx-ingress/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Loxilb nginx ingress - LoxiLB</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../stylesheets/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-21G7NBL2BN"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', "G-21G7NBL2BN");
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">LoxiLB</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Architectural Considerations</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../kube-loxilb/" class="dropdown-item">Understanding loxilb deployment in K8s with kube-loxilb</a>
</li>
                                    
<li>
    <a href="../ha-deploy/" class="dropdown-item">Understanding High-availability with loxilb</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Getting Started</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../k3s_quick_start_flannel/" class="dropdown-item">ext-cluster pod - K3s/loxilb with default flannel</a>
</li>
                                    
<li>
    <a href="../k3s_quick_start_calico/" class="dropdown-item">ext-cluster pod - K3s/loxilb with calico</a>
</li>
                                    
<li>
    <a href="../quick_start_with_cilium/" class="dropdown-item">ext-cluster pod - K3s/loxilb with cilium</a>
</li>
                                    
<li>
    <a href="../k0s_quick_start/" class="dropdown-item">ext-cluster pod - K0s/loxilb with kube-router</a>
</li>
                                    
<li>
    <a href="../k3s_quick_start_incluster/" class="dropdown-item">in-cluster pod - K3s/loxilb in-cluster mode</a>
</li>
                                    
<li>
    <a href="../k0s_quick_start_incluster/" class="dropdown-item">in-cluster pod - K0s/loxilb in-cluster mode</a>
</li>
                                    
<li>
    <a href="../microk8s_quick_start_incluster/" class="dropdown-item">in-cluster pod - MicroK8s/loxilb in-cluster mode</a>
</li>
                                    
<li>
    <a href="../service-proxy-flannel/" class="dropdown-item">service-proxy - K3s/loxilb service-proxy with flannel</a>
</li>
                                    
<li>
    <a href="../service-proxy-calico/" class="dropdown-item">service-proxy - K3s/loxilb service-proxy with calico</a>
</li>
                                    
<li>
    <a href="../standalone/" class="dropdown-item">loxilb in standalone mode</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Advanced Guides</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../service-zones/" class="dropdown-item">How-To - service-group zones</a>
</li>
                                    
<li>
    <a href="../ext-ep/" class="dropdown-item">How-To - access end-points outside K8s</a>
</li>
                                    
<li>
    <a href="../k3s-multi-master/" class="dropdown-item">How-To - Deploy multi-server K3s HA with loxilb</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Knowledge Base</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../ebpf/" class="dropdown-item">What is eBPF</a>
</li>
                                    
<li>
    <a href="../lb/" class="dropdown-item">What is k8s service - load-balancer</a>
</li>
                                    
<li>
    <a href="../arch/" class="dropdown-item">Architecture in brief</a>
</li>
                                    
<li>
    <a href="../code/" class="dropdown-item">Code organization</a>
</li>
                                    
<li>
    <a href="../loxilbebpf/" class="dropdown-item">eBPF internals</a>
</li>
                                    
<li>
    <a href="../nat/" class="dropdown-item">NAT Modes of loxilb</a>
</li>
                                    
<li>
    <a href="../lb-algo/" class="dropdown-item">loxilb load-balancer algorithms</a>
</li>
                                    
<li>
    <a href="../run/" class="dropdown-item">Manual steps to build/run</a>
</li>
                                    
<li>
    <a href="../debugging/" class="dropdown-item">Debugging loxilb</a>
</li>
                                    
<li>
    <a href="../cmd-dev/" class="dropdown-item">Developer's guide to loxicmd</a>
</li>
                                    
<li>
    <a href="../api-dev/" class="dropdown-item">Developer's guide to loxilb API</a>
</li>
                                    
<li>
    <a href="../api/" class="dropdown-item">loxilb api-reference</a>
</li>
                                    
<li>
    <a href="../perf/" class="dropdown-item">Performance Report</a>
</li>
                                    
<li>
    <a href="../roadmap/" class="dropdown-item">Development Roadmap</a>
</li>
                                    
<li>
    <a href="../contribute/" class="dropdown-item">Contribution Guide</a>
</li>
                                    
<li>
    <a href="../requirements/" class="dropdown-item">System Requirements</a>
</li>
                                    
<li>
    <a href="../faq/" class="dropdown-item">Frequenctly Asked Questions- FAQs</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Blogs</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="https://www.loxilb.io/post/loxilb-cluster-networking-elevating-k8s-networking-capabilities" class="dropdown-item">K8s - Elevating Cluster Networking</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/state-synchronization-of-ebpf-maps-using-go-a-tale-of-two-frameworks" class="dropdown-item">eBPF - Map Sync using Go</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/k8s-nuances-of-in-cluster-external-service-lb-with-loxilb" class="dropdown-item">K8s in-cluster service LB with LoxiLB</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/k8s-introducing-sctp-multihoming-functionality-with-loxilb" class="dropdown-item">K8s - Introducing SCTP Multihoming with LoxiLB</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/loxilb-anycast-service-load-balancing-with-high-availability" class="dropdown-item">Hyperscale anycast load balancing with HA</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/loxilb-load-balancer-setup-on-eks" class="dropdown-item">Getting started with loxilb on Amazon EKS</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/k8s-deploying-hitless-and-ha-load-balancing" class="dropdown-item">K8s - Deploying hitless Load-Balancing</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/k8s-exposing-ipv4-services-externally-as-ipv6" class="dropdown-item">Ipv6 migration in Kubernetes made easy</a>
</li>
                                    
<li>
    <a href="https://www.loxilb.io/post/running-loxilb-on-aws-graviton2-based-ec2-instance" class="dropdown-item">Load-balancer Perf comparison on Amazon Graviton2</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Community Posts</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="https://futuredon.medium.com/5g-sctp-loadbalancer-using-loxilb-b525198a9103" class="dropdown-item">5G SCTP LoadBalancer Using loxilb</a>
</li>
            
<li>
    <a href="https://futuredon.medium.com/5g-uplink-classifier-using-loxilb-7593a4d66f4c" class="dropdown-item">5G Uplink Classifier Using loxilb</a>
</li>
            
<li>
    <a href="https://cloudybytes.medium.com/k3s-using-loxilb-as-external-service-lb-2ea4ce61e159" class="dropdown-item">K3s - Using loxilb as external service lb</a>
</li>
            
<li>
    <a href="https://medium.com/@ben0978327139/5g-sctp-loadbalancer-using-loxilb-applying-on-free5gc-b5c05bb723f0" class="dropdown-item">5G SCTP LoadBalancer Using LoxiLB Applying on free5GC</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="https://www.loxilb.io/" class="nav-link">Visit Website</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/loxilb-io/loxilb/edit/master/docs/loxilb-nginx-ingress.md" class="nav-link">Edit on loxilb-io/loxilb
                                    </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#how-to-run-loxilb-with-ingress" class="nav-link">How to run loxilb with ingress</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#test" class="nav-link">Test</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="how-to-run-loxilb-with-ingress">How to run loxilb with ingress</h2>
<p>In Kubernetes, there is usually a lot of overlap between network load-balancer and an Ingress functionality. This creates a lot of confusion. Overall, the differences between an Ingress and a load-balancer service can be categorized as follows:</p>
<p><img alt="image" src="https://github.com/loxilb-io/loxilbdocs/assets/111065900/ed3fcbcb-2e8b-40d6-90dc-6b5f3539e963" /></p>
<p>With Kubernetes ingress, we can expose multiple paths with the same service IP. This might be helpful if one is using public cloud, where one has to pay for managed LB services. Hence, creating a single service and exposing mulitple URL paths might be optimal in such use-cases.</p>
<p>For this example, we will use ingress-nginx which is a kubernetes community driven ingress. loxilb itself also supports its own ingress ingress (not covered here), which is optimized for cases which require long-lived connections and https termination with eBPF. However, if someone needs more policy oriented ingress, ingress-nginx might be the right fit.</p>
<h3 id="considerations">Considerations</h3>
<p>This example is not specific to any particular managed kubernetes implementation like EKS, GKE etc but should work well with any. We will simply use K3s as a based kubernetes platform.</p>
<h3 id="install-k3s">Install K3s</h3>
<pre class="highlight"><code>curl -sfL https://get.k3s.io | INSTALL_K3S_EXEC="--disable traefik,servicelb" K3S_KUBECONFIG_MODE="644" sh -</code></pre>
<h3 id="install-loxilb">Install loxilb</h3>
<p>Follow any of the getting started <a href="https://github.com/loxilb-io/loxilb?tab=readme-ov-file#getting-started">guides</a> as per requirement. Check all the pods are up and running as expected :</p>
<pre class="highlight"><code>$ kubectl get pods -A
NAMESPACE     NAME                                     READY   STATUS    RESTARTS   AGE
kube-system   coredns-6799fbcd5-4n4kl                  1/1     Running   0          56m
kube-system   kube-loxilb-b466c99bb-fpgll              1/1     Running   0          56m
kube-system   local-path-provisioner-6f5d79df6-f52sw   1/1     Running   0          56m
kube-system   loxilb-lb-gbkw7                          1/1     Running   0          30s
kube-system   metrics-server-54fd9b65b-dchv2           1/1     Running   0          56m</code></pre>
<h3 id="install-ingress-nginx">Install ingress-nginx</h3>
<pre class="highlight"><code>kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.1/deploy/static/provider/baremetal/deploy.yaml</code></pre>
<p>Double confirm :
<pre class="highlight"><code>$ kubectl get pods -A
NAMESPACE       NAME                                        READY   STATUS      RESTARTS   AGE
ingress-nginx   ingress-nginx-admission-create-9vq66        0/1     Completed   0          113s
ingress-nginx   ingress-nginx-admission-patch-k4d74         0/1     Completed   1          113s
ingress-nginx   ingress-nginx-controller-845698f4f6-xq6hm   1/1     Running     0          113s
kube-system     coredns-6799fbcd5-4n4kl                     1/1     Running     0          59m
kube-system     kube-loxilb-b466c99bb-fpgll                 1/1     Running     0          59m
kube-system     local-path-provisioner-6f5d79df6-f52sw      1/1     Running     0          59m
kube-system     loxilb-lb-gbkw7                             1/1     Running     0          3m33s
kube-system     metrics-server-54fd9b65b-dchv2              1/1     Running     0          59m</code></pre></p>
<h3 id="install-service-backend-app-and-ingress-rules">Install service, backend app and ingress rules</h3>
<ul>
<li>Create a LB service for exposing ingress ports</li>
</ul>
<pre class="highlight"><code>apiVersion: v1
kind: Service
metadata:
  name: ingress-nginx-controller-loadbalancer
  namespace: ingress-nginx
spec:
  externalTrafficPolicy: Local
  loadBalancerClass: loxilb.io/loxilb
  selector:
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/name: ingress-nginx
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 80
    - name: https
      port: 443
      protocol: TCP
      targetPort: 443
  type: LoadBalancer</code></pre>
<p>Check the services created :</p>
<pre class="highlight"><code>$ kubectl get svc -A
NAMESPACE       NAME                                    TYPE           CLUSTER-IP      EXTERNAL-IP         PORT(S)                       AGE
default         kubernetes                              ClusterIP      10.43.0.1       &lt;none&gt;              443/TCP                       61m
ingress-nginx   ingress-nginx-controller                NodePort       10.43.114.138   &lt;none&gt;              80:30958/TCP,443:31794/TCP    3m22s
ingress-nginx   ingress-nginx-controller-admission      ClusterIP      10.43.107.66    &lt;none&gt;              443/TCP                       3m22s
ingress-nginx   ingress-nginx-controller-loadbalancer   LoadBalancer   10.43.27.248    llb-192.168.80.10   80:32218/TCP,443:32617/TCP    9s
kube-system     kube-dns                                ClusterIP      10.43.0.10      &lt;none&gt;              53/UDP,53/TCP,9153/TCP        61m
kube-system     loxilb-lb-service                       ClusterIP      None            &lt;none&gt;              11111/TCP,179/TCP,50051/TCP   5m2s
kube-system     metrics-server                          ClusterIP      10.43.20.55     &lt;none&gt;              443/TCP                       61m</code></pre>
<p>At this point of time, all services exposed via ingress can be accessed via "192.168.80.10". This IP could be different as per use-case and scenario. This IP can then be associated with DNS for name based access.</p>
<ul>
<li>Create backend apps for <code>domain1.loxilb.io</code> and configure ingress rules with the following yaml
<pre class="highlight"><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: site
spec:
  replicas: 1
  selector:
    matchLabels:
      name: site-nginx-frontend
  template:
    metadata:
      labels:
        name: site-nginx-frontend
    spec:
      containers:
        - name: blog
          image: ghcr.io/loxilb-io/nginx:stable
          imagePullPolicy: Always
          ports:
            - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: site-nginx-service
spec:
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 80
  selector:
    name: site-nginx-frontend
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: site-nginx-ingress
  annotations:
    #app.kubernetes.io/ingress.class: "nginx"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
spec:
  ingressClassName: nginx
  rules:
  - host: domain1.loxilb.io
    http:
      paths:
        - path: /
          pathType: Prefix
          backend:
            service:
              name: site-nginx-service
              port:
                number: 80</code></pre></li>
</ul>
<p>Double check status of pods, services and ingress:</p>
<pre class="highlight"><code>$ kubectl get pods -A
NAMESPACE       NAME                                        READY   STATUS      RESTARTS   AGE
default         site-69d64fcd49-j4qhj                       1/1     Running     0          46s
ingress-nginx   ingress-nginx-admission-create-9vq66        0/1     Completed   0          8m21s
ingress-nginx   ingress-nginx-admission-patch-k4d74         0/1     Completed   1          8m21s
ingress-nginx   ingress-nginx-controller-845698f4f6-xq6hm   1/1     Running     0          8m21s
kube-system     coredns-6799fbcd5-4n4kl                     1/1     Running     0          66m
kube-system     kube-loxilb-b466c99bb-fpgll                 1/1     Running     0          66m
kube-system     local-path-provisioner-6f5d79df6-f52sw      1/1     Running     0          66m
kube-system     loxilb-lb-gbkw7                             1/1     Running     0          10m
kube-system     metrics-server-54fd9b65b-dchv2              1/1     Running     0          66m

$ kubectl get svc -A
NAMESPACE       NAME                                    TYPE           CLUSTER-IP      EXTERNAL-IP         PORT(S)                       AGE
default         kubernetes                              ClusterIP      10.43.0.1       &lt;none&gt;              443/TCP                       67m
default         site-nginx-service                      ClusterIP      10.43.16.35     &lt;none&gt;              80/TCP                        108s
ingress-nginx   ingress-nginx-controller                NodePort       10.43.114.138   &lt;none&gt;              80:30958/TCP,443:31794/TCP    9m23s
ingress-nginx   ingress-nginx-controller-admission      ClusterIP      10.43.107.66    &lt;none&gt;              443/TCP                       9m23s
ingress-nginx   ingress-nginx-controller-loadbalancer   LoadBalancer   10.43.27.248    llb-192.168.80.10   80:32218/TCP,443:32617/TCP    6m10s
kube-system     kube-dns                                ClusterIP      10.43.0.10      &lt;none&gt;              53/UDP,53/TCP,9153/TCP        67m
kube-system     loxilb-lb-service                       ClusterIP      None            &lt;none&gt;              11111/TCP,179/TCP,50051/TCP   11m
kube-system     metrics-server                          ClusterIP      10.43.20.55     &lt;none&gt;              443/TCP                       67m


$ kubectl get ingress -A
NAMESPACE   NAME                 CLASS   HOSTS               ADDRESS     PORTS   AGE
default     site-nginx-ingress   nginx   domain1.loxilb.io   10.0.2.15   80      2m10s
</code></pre>
<ul>
<li>Now, lets create backend apps for <code>domain2.loxilb.io</code> and configure ingress rules with the following yaml
<pre class="highlight"><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: site2
spec:
  replicas: 1
  selector:
    matchLabels:
      name: site-nginx-frontend2
  template:
    metadata:
      labels:
        name: site-nginx-frontend2
    spec:
      containers:
        - name: blog
          image: ghcr.io/loxilb-io/nginx:stable
          imagePullPolicy: Always
          ports:
            - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: site-nginx-service2
spec:
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 80
  selector:
    name: site-nginx-frontend2
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: site-nginx-ingress2
  annotations:
    #app.kubernetes.io/ingress.class: "nginx"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
spec:
  ingressClassName: nginx
  rules:
  - host: domain2.loxilb.io
    http:
      paths:
        - path: /
          pathType: Prefix
          backend:
            service:
              name: site-nginx-service2
              port:
                number: 80</code></pre></li>
</ul>
<p>Again, we can check the status of pods, service and ingress:
<pre class="highlight"><code>$ kubectl get pods -A
NAMESPACE       NAME                                        READY   STATUS      RESTARTS   AGE
default         site-69d64fcd49-j4qhj                       1/1     Running     0          9m12s
default         site2-7fff6cfbbf-8d6rp                      1/1     Running     0          2m34s
ingress-nginx   ingress-nginx-admission-create-9vq66        0/1     Completed   0          16m
ingress-nginx   ingress-nginx-admission-patch-k4d74         0/1     Completed   1          16m
ingress-nginx   ingress-nginx-controller-845698f4f6-xq6hm   1/1     Running     0          16m
kube-system     coredns-6799fbcd5-4n4kl                     1/1     Running     0          74m
kube-system     kube-loxilb-b466c99bb-fpgll                 1/1     Running     0          74m
kube-system     local-path-provisioner-6f5d79df6-f52sw      1/1     Running     0          74m
kube-system     loxilb-lb-gbkw7                             1/1     Running     0          18m
kube-system     metrics-server-54fd9b65b-dchv2              1/1     Running     0          74m

$ kubectl get svc -A
NAMESPACE       NAME                                    TYPE           CLUSTER-IP      EXTERNAL-IP         PORT(S)                       AGE
default         kubernetes                              ClusterIP      10.43.0.1       &lt;none&gt;              443/TCP                       75m
default         site-nginx-service                      ClusterIP      10.43.16.35     &lt;none&gt;              80/TCP                        9m32s
default         site-nginx-service2                     ClusterIP      10.43.107.99    &lt;none&gt;              80/TCP                        2m54s
ingress-nginx   ingress-nginx-controller                NodePort       10.43.114.138   &lt;none&gt;              80:30958/TCP,443:31794/TCP    17m
ingress-nginx   ingress-nginx-controller-admission      ClusterIP      10.43.107.66    &lt;none&gt;              443/TCP                       17m
ingress-nginx   ingress-nginx-controller-loadbalancer   LoadBalancer   10.43.27.248    llb-192.168.80.10   80:32218/TCP,443:32617/TCP    13m
kube-system     kube-dns                                ClusterIP      10.43.0.10      &lt;none&gt;              53/UDP,53/TCP,9153/TCP        75m
kube-system     loxilb-lb-service                       ClusterIP      None            &lt;none&gt;              11111/TCP,179/TCP,50051/TCP   18m
kube-system     metrics-server                          ClusterIP      10.43.20.55     &lt;none&gt;              443/TCP                       75m

$ kubectl get ingress -A
NAMESPACE   NAME                  CLASS   HOSTS               ADDRESS     PORTS   AGE
default     site-nginx-ingress    nginx   domain1.loxilb.io   10.0.2.15   80      9m49s
default     site-nginx-ingress2   nginx   domain2.loxilb.io   10.0.2.15   80      3m11s</code></pre></p>
<h2 id="test">Test</h2>
<p>If you are testing locally you can simply add the following for dns resolution in your bastion/host :</p>
<p><pre class="highlight"><code>$ tail -n 2  /etc/hosts
192.168.80.10   domain1.loxilb.io
192.168.80.10   domain2.loxilb.io
</code></pre>
The above step is similar to adding A records in a DNS like route53.</p>
<ul>
<li>
<p>Finally, try to access the service "domain1.loxilb.io" :
<pre class="highlight"><code>$ curl -H "HOST: domain1.loxilb.io" domain1.loxilb.io
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></p>
</li>
<li>
<p>And then try to access services domain2.loxilb.io:
<pre class="highlight"><code>$ curl -H "HOST: domain2.loxilb.io" domain2.loxilb.io
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
