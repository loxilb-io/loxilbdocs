<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://loxilb-io.github.io/loxilbdocs/gtp/" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Creating a simple test topology for testing GTP with loxilb - loxilb v0.9.1</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-21G7NBL2BN"></script>
<script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', "G-21G7NBL2BN");
        </script>
</head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
<div class="container">
<a class="navbar-brand" href="..">loxilb v0.9.1</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href="..">Home</a>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">How-To Guides <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../kube-loxilb/">How-To - kube-loxilb</a>
</li>
<li>
<a class="dropdown-item" href="../service-zones/">How-To - service-group zones</a>
</li>
<li>
<a class="dropdown-item" href="../run/">How-To - build/run</a>
</li>
<li>
<a class="dropdown-item" href="../cmd/">How-To - configuration</a>
</li>
<li>
<a class="dropdown-item" href="../debugging/">How-To - debug</a>
</li>
<li>
<a class="dropdown-item" href="../integrate_bgp_eng/">How-To - loxilb with calico bgp</a>
</li>
<li>
<a class="dropdown-item" href="../standalone/">How-To - loxilb in standalone mode</a>
</li>
<li>
<a class="dropdown-item" href="../api/">How-To - loxilb Web-APIs</a>
</li>
<li>
<a class="dropdown-item" href="../ha-deploy/">How-To - high-availability with loxilb</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Knowledge Base <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../ebpf/">What is eBPF</a>
</li>
<li>
<a class="dropdown-item" href="../lb/">What is k8s service - load-balancer</a>
</li>
<li>
<a class="dropdown-item" href="../arch/">Architecture in brief</a>
</li>
<li>
<a class="dropdown-item" href="../code/">Code organization</a>
</li>
<li>
<a class="dropdown-item" href="../loxilbebpf/">eBPF internals</a>
</li>
<li>
<a class="dropdown-item" href="../nat/">NAT Modes of loxilb</a>
</li>
<li>
<a class="dropdown-item" href="../lb-algo/">loxilb load-balancer algorithms</a>
</li>
<li>
<a class="dropdown-item" href="../cmd-dev/">Developer's guide to loxicmd</a>
</li>
<li>
<a class="dropdown-item" href="../api-dev/">Developer's guide to loxilb API</a>
</li>
<li>
<a class="dropdown-item" href="../perf/">Performance Report</a>
</li>
<li>
<a class="dropdown-item" href="../roadmap/">Development Roadmap</a>
</li>
<li>
<a class="dropdown-item" href="../contribute/">Contribution Guide</a>
</li>
<li>
<a class="dropdown-item" href="../requirements/">System Requirements</a>
</li>
<li>
<a class="dropdown-item" href="../faq/">Frequenctly Asked Questions- FAQs</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Blogs <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/loxilb-cluster-networking-elevating-k8s-networking-capabilities">K8s - Elevating Cluster Networking</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/state-synchronization-of-ebpf-maps-using-go-a-tale-of-two-frameworks">eBPF - Map Sync using Go</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/k8s-nuances-of-in-cluster-external-service-lb-with-loxilb">K8s in-cluster service LB with LoxiLB</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/k8s-introducing-sctp-multihoming-functionality-with-loxilb">K8s - Introducing SCTP Multihoming with LoxiLB</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/loxilb-anycast-service-load-balancing-with-high-availability">Hyperscale anycast load balancing with HA</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/loxilb-load-balancer-setup-on-eks">Getting started with loxilb on Amazon EKS</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/k8s-deploying-hitless-and-ha-load-balancing">K8s - Deploying hitless Load-Balancing</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/k8s-exposing-ipv4-services-externally-as-ipv6">Ipv6 migration in Kubernetes made easy</a>
</li>
<li>
<a class="dropdown-item" href="https://www.loxilb.io/post/running-loxilb-on-aws-graviton2-based-ec2-instance">Load-balancer Perf comparison on Amazon Graviton2</a>
</li>
<li class="dropdown-submenu">
<a class="dropdown-item" href="#">Community Posts</a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="https://futuredon.medium.com/5g-sctp-loadbalancer-using-loxilb-b525198a9103">5G SCTP LoadBalancer Using loxilb</a>
</li>
<li>
<a class="dropdown-item" href="https://futuredon.medium.com/5g-uplink-classifier-using-loxilb-7593a4d66f4c">5G Uplink Classifier Using loxilb</a>
</li>
<li>
<a class="dropdown-item" href="https://cloudybytes.medium.com/k3s-using-loxilb-as-external-service-lb-2ea4ce61e159">K3s - Using loxilb as external service lb</a>
</li>
<li>
<a class="dropdown-item" href="https://medium.com/@ben0978327139/5g-sctp-loadbalancer-using-loxilb-applying-on-free5gc-b5c05bb723f0">5G SCTP LoadBalancer Using LoxiLB Applying on free5GC</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
<li class="nav-item" data-level="1"><a class="nav-link" href="#creating-a-simple-test-topology-for-testing-gtp-with-loxilb">Creating a simple test topology for testing GTP with loxilb</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="2"><a class="nav-link" href="#next-step-is-to-run-the-following-script-to-create-and-configure-the-above-topology">Next step is to run the following script to create and configure the above topology.</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<h1 id="creating-a-simple-test-topology-for-testing-gtp-with-loxilb">Creating a simple test topology for testing GTP with loxilb</h1>
<p>To test loxilb in a completely virtual environment, it is possible to quickly create a virtual test topology. We will explain the steps required to create a very simple topology (more complex topologies can be built using this example) :</p>
<div class="mermaid">graph LR;
    UE1[UE1&lt;br&gt;32.32.32.1]--&gt;B[llb1&lt;br&gt;10.10.10.59/24];
    UE2[UE2&lt;br&gt;31.31.31.1]--&gt;B;
    B-- GTP Tunnel ---C[llb2&lt;br&gt;10.10.10.56/24]
    C--&gt;D[EP1&lt;br&gt;31.31.31.1];
    C--&gt;E[EP2&lt;br&gt;32.32.32.1];
    C--&gt;F[EP3&lt;br&gt;17.17.17.1];
</div>
<p>Prerequisites :  </p>
<ul>
<li>The system should be x86 based (bare-metal or virtual)  </li>
<li>Docker should be preinstalled  </li>
</ul>
<h2 id="next-step-is-to-run-the-following-script-to-create-and-configure-the-above-topology">Next step is to run the following script to create and configure the above topology.</h2>
<p>Please refer scenario3 in loxilb/cicd <a href="https://github.com/loxilb-io/loxilb/blob/main/cicd/scenario3/config.sh">script</a></p>
<p>Script will spawn dockers for UEs, loxilbs and endpoints. </p>
<p>In the script, UEs will try to access service IP(88.88.88.88). We are creating sessions and configuring load-balancer rule inside loxilb docker as follows :</p>
<pre><code>dexec="docker exec -it "
##llb1 config

#Creating session for ue1
$dexec llb1 loxicmd create session user1 88.88.88.88 --accessNetworkTunnel 1:10.10.10.56 --coreNetworkTunnel=1:10.10.10.59

#Creating ULCL filter with ue1 IP
$dexec llb1 loxicmd create sessionulcl user1 --ulclArgs=11:32.32.32.1

#Creating session for ue2
$dexec llb1 loxicmd create session user2 88.88.88.88 --accessNetworkTunnel 2:10.10.10.56 --coreNetworkTunnel=2:10.10.10.59

#Creating ULCL filter with ue2 IP
$dexec llb1 loxicmd create sessionulcl user2 --ulclArgs=12:31.31.31.1

##llb2 config
#Creating session for ue1
$dexec llb2 loxicmd create session user1 32.32.32.1 --accessNetworkTunnel 1:10.10.10.59 --coreNetworkTunnel=1:10.10.10.56

#Creating ULCL filter with service IP for ue1
$dexec llb2 loxicmd create sessionulcl user1 --ulclArgs=11:88.88.88.88

#Creating session for ue1
$dexec llb2 loxicmd create session user2 31.31.31.1 --accessNetworkTunnel 2:10.10.10.59 --coreNetworkTunnel=2:10.10.10.56

#Creating ULCL filter with service IP for ue2
$dexec llb2 loxicmd create sessionulcl user2 --ulclArgs=12:88.88.88.88


##Create LB rule
$dexec llb2 loxicmd create lb 88.88.88.88 --tcp=2020:8080 --endpoints=25.25.25.1:1,26.26.26.1:1,27.27.27.1:1
</code></pre>
<p>So, we now have two instances loxilb running as a docker.
First instance of loxilb, llb1 is simulated as gNB as it is used to encap the incoming traffic from UE1 or UE2. Breakout, forward or loadbalancer rule can be configured on second instance llb2
We can run any workloads as we wish inside the host containers and start testing loxilb.</p></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script src="../js/jquery-3.6.0.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script src="../js/base.js"></script>
<div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>
